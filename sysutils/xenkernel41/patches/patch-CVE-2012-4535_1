$NetBSD: patch-CVE-2012-4535_1,v 1.1 2012/11/14 13:42:41 drochner Exp $

see http://lists.xen.org/archives/html/xen-devel/2012-11/msg00502.html

--- xen/common/domain.c.orig	2012-08-10 13:51:47.000000000 +0000
+++ xen/common/domain.c
@@ -871,6 +871,9 @@ long do_vcpu_op(int cmd, int vcpuid, XEN
         if ( set.period_ns < MILLISECS(1) )
             return -EINVAL;
 
+	if ( set.period_ns > STIME_DELTA_MAX )
+	    return -EINVAL;
+
         v->periodic_period = set.period_ns;
         vcpu_force_reschedule(v);
 
